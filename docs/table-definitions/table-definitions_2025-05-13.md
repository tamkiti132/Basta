# テーブル定義書

## users テーブル

| 項番 | PK  | FK  | UK  | カラム名           | 項目名                 | データ型      | Not Null | デフォルト | 備考                               |
| ---- | :-: | :-: | :-: | ------------------ | ---------------------- | ------------- | :------: | ---------- | ---------------------------------- |
| 1    |  ●  |     |  ●  | id                 | ID                     | INT           |    ●     |            |                                    |
| 2    |     |     |  ●  | email              | メールアドレス         | VARCHAR(255)  |    ●     |            |                                    |
| 3    |     |     |  ●  | password           | パスワード             | VARCHAR(255)  |    ●     |            |                                    |
| 4    |     |     |     | nickname           | ニックネーム           | VARCHAR(13)   |    ●     |            |                                    |
| 5    |     |     |  ●  | username           | ユーザー名             | CHAR(27)      |    ●     |            |                                    |
| 6    |     |     |     | google_id          | グーグル ID            | VARCHAR(255)  |          |            | Google のソーシャルログイン用の ID |
| 7    |     |     |     | profile_photo_path | プロフィール画像のパス | VARCHAR(2048) |          |            |                                    |
| 8    |     |     |     | suspension_state   | 利用停止状態           | BOOL          |    ●     | 0          | 0：利用停止なし<br>1：利用停止中   |
| 9    |     |     |     | created_at         | 登録日時               | DATETIME      |    ●     |            |                                    |
| 10   |     |     |     | updated_at         | 更新日時               | DATETIME      |    ●     |            |                                    |

## groups テーブル

| 項番 | PK  | FK  | UK  | カラム名          | 項目名             | データ型      | Not Null | デフォルト | 備考                             |
| ---- | :-: | :-: | :-: | ----------------- | ------------------ | ------------- | :------: | ---------- | -------------------------------- |
| 1    |  ●  |     |  ●  | id                | ID                 | INT           |    ●     |            |                                  |
| 2    |     |     |     | group_photo_path  | グループ画像のパス | VARCHAR(2048) |          |            |                                  |
| 3    |     |     |     | name              | グループ名         | VARCHAR(50)   |    ●     |            |                                  |
| 4    |     |     |     | introduction      | グループ紹介文     | VARCHAR(200)  |    ●     |            |                                  |
| 5    |     |     |     | isJoinFreeEnabled | 自由参加許可       | BOOL          |    ●     | 0          | 0：許可しない<br>1：許可する     |
| 6    |     |     |     | isTipEnabled      | 投げ銭許可         | BOOL          |    ●     | 0          | 0：許可しない<br>1：許可する     |
| 7    |     |     |     | suspension_state  | 利用停止状態       | BOOL          |    ●     | 0          | 0：利用停止なし<br>1：利用停止中 |
| 8    |     |     |     | created_at        | 登録日時           | DATETIME      |    ●     |            |                                  |
| 9    |     |     |     | updated_at        | 更新日時           | DATETIME      |    ●     |            |                                  |

## roles テーブル

| 項番 | PK  | FK  | UK  | カラム名   | 項目名      | データ型 | Not Null | デフォルト | 備考                                                                      |
| ---- | :-: | :-: | :-: | ---------- | ----------- | -------- | :------: | ---------- | ------------------------------------------------------------------------- |
| 1    |  ●  |     |  ●  | id         | ID          | INT      |    ●     |            |                                                                           |
| 2    |     |  ●  |     | user_id    | ユーザー ID | INT      |    ●     |            |                                                                           |
| 3    |     |  ●  |     | group_id   | グループ ID | INT      |    ●     |            |                                                                           |
| 4    |     |     |     | role       | 権限        | INT      |    ●     | 100        | 3：運営トップ<br>5：運営<br>10：管理者<br>50：サブ管理者<br>100：メンバー |
| 5    |     |     |     | created_at | 登録日時    | DATETIME |    ●     |            |                                                                           |
| 6    |     |     |     | updated_at | 更新日時    | DATETIME |    ●     |            |                                                                           |

## block_states テーブル

| 項番 | PK  | FK  | UK  | カラム名 | 項目名      | データ型 | Not Null | デフォルト | 備考 |
| ---- | :-: | :-: | :-: | -------- | ----------- | -------- | :------: | ---------- | ---- |
| 1    |     |  ●  |     | user_id  | ユーザー ID | INT      |    ●     |            |      |
| 2    |     |  ●  |     | group_id | グループ ID | INT      |    ●     |            |      |

## memos テーブル

| 項番 | PK  | FK  | UK  | カラム名       | 項目名       | データ型     | Not Null | デフォルト | 備考            |
| ---- | :-: | :-: | :-: | -------------- | ------------ | ------------ | :------: | ---------- | --------------- |
| 1    |  ●  |     |  ●  | id             | ID           | INT          |    ●     |            |                 |
| 2    |     |  ●  |     | user_id        | ユーザー ID  | INT          |    ●     |            |                 |
| 3    |     |  ●  |     | group_id       | グループ ID  | INT          |    ●     |            |                 |
| 4    |     |     |     | title          | タイトル     | VARCHAR(50)  |    ●     |            |                 |
| 5    |     |     |     | shortMemo      | ひとことメモ | VARCHAR(200) |    ●     |            |                 |
| 6    |     |     |     | additionalMemo | 追加メモ     | TEXT         |          |            |                 |
| 7    |     |     |     | type           | メモタイプ   | TINYINT      |    ●     |            | 0:web<br>1:book |
| 8    |     |     |     | created_at     | 登録日時     | DATETIME     |    ●     |            |                 |
| 9    |     |     |     | updated_at     | 更新日時     | DATETIME     |    ●     |            |                 |

## web_type_features テーブル

| 項番 | PK  | FK  | UK  | カラム名   | 項目名   | データ型 | Not Null | デフォルト | 備考 |
| ---- | :-: | :-: | :-: | ---------- | -------- | -------- | :------: | ---------- | ---- |
| 1    |  ●  |     |  ●  | id         | ID       | INT      |    ●     |            |      |
| 2    |     |  ●  |  ●  | memo_id    | メモ ID  | INT      |    ●     |            |      |
| 3    |     |     |     | url        | URL      | TEXT     |    ●     |            |      |
| 4    |     |     |     | created_at | 登録日時 | DATETIME |    ●     |            |      |
| 5    |     |     |     | updated_at | 更新日時 | DATETIME |    ●     |            |      |

## book_type_features テーブル

| 項番 | PK  | FK  | UK  | カラム名        | 項目名         | データ型      | Not Null | デフォルト | 備考 |
| ---- | :-: | :-: | :-: | --------------- | -------------- | ------------- | :------: | ---------- | ---- |
| 1    |  ●  |     |  ●  | id              | ID             | INT           |    ●     |            |      |
| 2    |     |  ●  |  ●  | memo_id         | メモ ID        | INT           |    ●     |            |      |
| 3    |     |     |     | book_photo_path | 本の画像のパス | VARCHAR(2048) |          |            |      |
| 4    |     |     |     | created_at      | 登録日時       | DATETIME      |    ●     |            |      |
| 5    |     |     |     | updated_at      | 更新日時       | DATETIME      |    ●     |            |      |

## label_memos テーブル

| 項番 | PK  | FK  | UK  | カラム名 | 項目名    | データ型 | Not Null | デフォルト | 備考 |
| ---- | :-: | :-: | :-: | -------- | --------- | -------- | :------: | ---------- | ---- |
| 1    |  ●  |     |  ●  | id       | ID        | INT      |    ●     |            |      |
| 2    |     |  ●  |     | memo_id  | メモ ID   | INT      |    ●     |            |      |
| 3    |     |  ●  |     | label_id | ラベル ID | INT      |    ●     |            |      |

## labels テーブル

| 項番 | PK  | FK  | UK  | カラム名   | 項目名      | データ型    | Not Null | デフォルト | 備考                                  |
| ---- | :-: | :-: | :-: | ---------- | ----------- | ----------- | :------: | ---------- | ------------------------------------- |
| 1    |  ●  |     |  ●  | id         | ID          | INT         |    ●     |            |                                       |
| 2    |     |     |     | name       | ラベル名    | VARCHAR(30) |    ●     |            |                                       |
| 3    |     |  ●  |     | group_id   | グループ ID | INT         |    ●     |            |                                       |
| 4    |     |     |     | created_at | 登録日時    | DATETIME    |    ●     |            |                                       |
| 5    |     |     |     | updated_at | 更新日時    | DATETIME    |    ●     |            |                                       |
| 6    |     |     |  ●  |            |             |             |          |            | group_id + name<br>で複合ユニーク制約 |

## comments テーブル

| 項番 | PK  | FK  | UK  | カラム名   | 項目名      | データ型 | Not Null | デフォルト | 備考 |
| ---- | :-: | :-: | :-: | ---------- | ----------- | -------- | :------: | ---------- | ---- |
| 1    |  ●  |     |  ●  | id         | ID          | INT      |    ●     |            |      |
| 2    |     |     |     | comment    | コメント    | TEXT     |    ●     |            |      |
| 3    |     |  ●  |     | user_id    | ユーザー ID | INT      |    ●     |            |      |
| 4    |     |  ●  |     | memo_id    | メモ ID     | INT      |    ●     |            |      |
| 5    |     |     |     | created_at | 登録日時    | DATETIME |    ●     |            |      |
| 6    |     |     |     | updated_at | 更新日時    | DATETIME |    ●     |            |      |

## goods テーブル

| 項番 | PK  | FK  | UK  | カラム名   | 項目名      | データ型 | Not Null | デフォルト | 備考 |
| ---- | :-: | :-: | :-: | ---------- | ----------- | -------- | :------: | ---------- | ---- |
| 1    |  ●  |     |  ●  | id         | ID          | INT      |    ●     |            |      |
| 2    |     |  ●  |     | user_id    | ユーザー ID | INT      |    ●     |            |      |
| 3    |     |  ●  |     | memo_id    | メモ ID     | INT      |    ●     |            |      |
| 4    |     |     |     | created_at | 登録日時    | DATETIME |    ●     |            |      |
| 5    |     |     |     | updated_at | 更新日時    | DATETIME |    ●     |            |      |

## later_reads テーブル

| 項番 | PK  | FK  | UK  | カラム名   | 項目名      | データ型 | Not Null | デフォルト | 備考 |
| ---- | :-: | :-: | :-: | ---------- | ----------- | -------- | :------: | ---------- | ---- |
| 1    |  ●  |     |  ●  | id         | ID          | INT      |    ●     |            |      |
| 2    |     |  ●  |     | user_id    | ユーザー ID | INT      |    ●     |            |      |
| 3    |     |  ●  |     | memo_id    | メモ ID     | INT      |    ●     |            |      |
| 4    |     |     |     | created_at | 登録日時    | DATETIME |    ●     |            |      |
| 5    |     |     |     | updated_at | 更新日時    | DATETIME |    ●     |            |      |

## reports テーブル

| 項番 | PK  | FK  | UK  | カラム名           | 項目名             | データ型 | Not Null | デフォルト | 備考                                                                           |
| ---- | :-: | :-: | :-: | ------------------ | ------------------ | -------- | :------: | ---------- | ------------------------------------------------------------------------------ |
| 1    |  ●  |     |  ●  | id                 | ID                 | INT      |    ●     |            |                                                                                |
| 2    |     |  ●  |     | contribute_user_id | 通報ユーザー ID    | INT      |    ●     |            | 通報を送信したユーザー                                                         |
| 3    |     |     |     | type               | 通報対象タイプ     | TINYINT  |    ●     |            | 1：ユーザー<br>2：メモ<br>3：コメント<br>4：グループ                           |
| 4    |     |     |     | reason             | 通報理由           | TINYINT  |    ●     |            | 1：法律違反<br>2：不適切なコンテンツ<br>3：フィッシング or スパム<br>4：その他 |
| 5    |     |     |     | detail             | 問題がある点の詳細 | TEXT     |    ●     |            |                                                                                |
| 6    |     |     |     | created_at         | 登録日時           | DATETIME |    ●     |            |                                                                                |
| 7    |     |     |     | updated_at         | 更新日時           | DATETIME |    ●     |            |                                                                                |

## report_users テーブル

| 項番 | PK  | FK  | UK  | カラム名  | 項目名      | データ型 | Not Null | デフォルト | 備考 |
| ---- | :-: | :-: | :-: | --------- | ----------- | -------- | :------: | ---------- | ---- |
| 1    |  ●  |     |  ●  | id        | ID          | INT      |    ●     |            |      |
| 2    |     |  ●  |     | report_id | レポート ID | INT      |    ●     |            |      |
| 3    |     |  ●  |     | user_id   | ユーザー ID | INT      |    ●     |            |      |

## report_memos テーブル

| 項番 | PK  | FK  | UK  | カラム名  | 項目名      | データ型 | Not Null | デフォルト | 備考 |
| ---- | :-: | :-: | :-: | --------- | ----------- | -------- | :------: | ---------- | ---- |
| 1    |  ●  |     |  ●  | id        | ID          | INT      |    ●     |            |      |
| 2    |     |  ●  |     | report_id | レポート ID | INT      |    ●     |            |      |
| 3    |     |  ●  |     | memo_id   | メモ ID     | INT      |    ●     |            |      |

## report_comments テーブル

| 項番 | PK  | FK  | UK  | カラム名   | 項目名      | データ型 | Not Null | デフォルト | 備考 |
| ---- | :-: | :-: | :-: | ---------- | ----------- | -------- | :------: | ---------- | ---- |
| 1    |  ●  |     |  ●  | id         | ID          | INT      |    ●     |            |      |
| 2    |     |  ●  |     | report_id  | レポート ID | INT      |    ●     |            |      |
| 3    |     |  ●  |     | comment_id | コメント ID | INT      |    ●     |            |      |

## report_groups テーブル

| 項番 | PK  | FK  | UK  | カラム名  | 項目名      | データ型 | Not Null | デフォルト | 備考 |
| ---- | :-: | :-: | :-: | --------- | ----------- | -------- | :------: | ---------- | ---- |
| 1    |  ●  |     |  ●  | id        | ID          | INT      |    ●     |            |      |
| 2    |     |  ●  |     | report_id | レポート ID | INT      |    ●     |            |      |
| 3    |     |  ●  |     | group_id  | グループ ID | INT      |    ●     |            |      |
